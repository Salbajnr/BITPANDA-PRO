import{u as M,a as q,b as V,r as u,c as b,d as B,j as e,S as K,N as U,T as Q,e as $,f as j,g,C as n,h as x,i as o,B as y,k as H,l as c,m as O,D as Y,n as _,o as J,p as z,q as p,A as G,s as W,t as X,v as Z,L as ee,I as se,w as te,P as ae}from"./index-locF26TT.js";function ne(){const{user:w}=M(),{toast:m}=q(),I=V(),[a,v]=u.useState(null),[r,N]=u.useState(""),[k,f]=u.useState("available"),{data:C=[],isLoading:D}=b({queryKey:["/api/investment-plans"],queryFn:async()=>{const s=await fetch("/api/investment-plans",{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch investment plans");return s.json()}}),{data:i=[],isLoading:T}=b({queryKey:["/api/investment-plans/my-investments"],queryFn:async()=>{const s=await fetch("/api/investment-plans/my-investments",{credentials:"include"});if(!s.ok)throw new Error("Failed to fetch user investments");return s.json()},enabled:!!w}),h=B({mutationFn:async s=>{const t=await fetch("/api/investment-plans/invest",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(!t.ok)throw new Error("Investment failed");return t.json()},onSuccess:()=>{m({title:"Investment Successful",description:"Your investment has been created successfully."}),I.invalidateQueries({queryKey:["/api/investment-plans/my-investments"]}),v(null),N("")},onError:s=>{m({title:"Investment Failed",description:s.message})}}),S=s=>{switch(s){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},l=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),P=(s,t)=>{const d=new Date(s).getTime(),F=new Date(t).getTime(),R=Date.now(),L=F-d,E=R-d;return Math.min(Math.max(E/L*100,0),100)},A=()=>{if(!a||!r)return;const s=parseFloat(r);if(s<a.minInvestment){m({title:"Invalid Amount",description:`Minimum investment is ${l(a.minInvestment)}`});return}h.mutate({planId:a.id,amount:s})};return e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:e.jsxs("div",{className:"flex h-screen",children:[e.jsx(K,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(U,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"Investment Plans"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Diversify your portfolio with our curated investment opportunities"})]}),e.jsxs(Q,{value:k,onValueChange:f,className:"space-y-6",children:[e.jsxs($,{className:"grid w-full grid-cols-3",children:[e.jsx(j,{value:"available",children:"Available Plans"}),e.jsx(j,{value:"my-investments",children:"My Investments"}),e.jsx(j,{value:"performance",children:"Performance"})]}),e.jsx(g,{value:"available",className:"space-y-6",children:D?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,t)=>e.jsx(n,{className:"h-80 animate-pulse",children:e.jsx("div",{className:"h-full bg-slate-200 dark:bg-slate-700 rounded-lg"})},t))}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(s=>e.jsxs(n,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(x,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-lg",children:s.name}),e.jsxs(y,{className:S(s.riskLevel),children:[s.riskLevel.toUpperCase()," RISK"]})]}),e.jsx(H,{children:s.description})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Expected Return"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[s.expectedReturn,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Duration"}),e.jsxs("p",{className:"text-lg font-bold",children:[s.duration," months"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Min. Investment"}),e.jsx("p",{className:"text-lg font-bold",children:l(s.minInvestment)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Features:"}),e.jsx("ul",{className:"text-xs space-y-1",children:s.features.slice(0,3).map((t,d)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-3 w-3 text-green-500"}),t]},d))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-slate-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-3 w-3"}),l(s.totalInvested)," invested"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-3 w-3"}),s.totalInvestors," investors"]})]}),e.jsxs(J,{children:[e.jsx(z,{asChild:!0,children:e.jsxs(p,{className:"w-full",onClick:()=>v(s),children:["Invest Now",e.jsx(G,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(Z,{children:["Invest in ",a?.name]})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Expected Return:"}),e.jsxs("span",{className:"font-bold text-green-600 ml-2",children:[a.expectedReturn,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Duration:"}),e.jsxs("span",{className:"font-bold ml-2",children:[a.duration," months"]})]})]})}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"investment-amount",children:"Investment Amount"}),e.jsx(se,{id:"investment-amount",type:"number",placeholder:`Min. ${l(a.minInvestment)}`,value:r,onChange:t=>N(t.target.value)})]}),r&&parseFloat(r)>0&&e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["Expected value after ",a.duration," months:"]}),e.jsx("p",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:l(parseFloat(r)*(1+a.expectedReturn/100))})]}),e.jsx(p,{onClick:A,disabled:h.isPending||!r,className:"w-full",children:h.isPending?"Processing...":"Confirm Investment"})]})]})]})]})]},s.id))})}),e.jsx(g,{value:"my-investments",className:"space-y-6",children:T?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,t)=>e.jsx(n,{className:"h-32 animate-pulse",children:e.jsx("div",{className:"h-full bg-slate-200 dark:bg-slate-700 rounded-lg"})},t))}):i.length===0?e.jsx(n,{children:e.jsxs(c,{className:"p-8 text-center",children:[e.jsx(te,{className:"h-12 w-12 mx-auto mb-4 text-slate-400"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Investments Yet"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:"Start your investment journey by choosing from our available plans."}),e.jsx(p,{onClick:()=>f("available"),children:"Browse Investment Plans"})]})}):e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsx(n,{children:e.jsxs(c,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.planName}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Started ",new Date(s.startDate).toLocaleDateString()]})]}),e.jsx(y,{variant:s.status==="active"?"default":"secondary",children:s.status.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Invested"}),e.jsx("p",{className:"text-lg font-bold",children:l(s.investedAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Current Value"}),e.jsx("p",{className:"text-lg font-bold",children:l(s.currentValue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Expected Return"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[s.expectedReturn.toFixed(2),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Actual Return"}),e.jsxs("p",{className:`text-lg font-bold ${s.actualReturn>=0?"text-green-600":"text-red-600"}`,children:[s.actualReturn.toFixed(2),"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Progress"}),e.jsx("span",{children:new Date(s.endDate).toLocaleDateString()})]}),e.jsx(ae,{value:P(s.startDate,s.endDate),className:"h-2"})]})]})},s.id))})}),e.jsx(g,{value:"performance",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(n,{children:[e.jsx(x,{children:e.jsx(o,{className:"text-sm font-medium",children:"Total Invested"})}),e.jsx(c,{children:e.jsx("p",{className:"text-2xl font-bold",children:l(i.reduce((s,t)=>s+t.investedAmount,0))})})]}),e.jsxs(n,{children:[e.jsx(x,{children:e.jsx(o,{className:"text-sm font-medium",children:"Current Value"})}),e.jsx(c,{children:e.jsx("p",{className:"text-2xl font-bold",children:l(i.reduce((s,t)=>s+t.currentValue,0))})})]}),e.jsxs(n,{children:[e.jsx(x,{children:e.jsx(o,{className:"text-sm font-medium",children:"Total Return"})}),e.jsx(c,{children:e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[((i.reduce((s,t)=>s+t.currentValue,0)/Math.max(i.reduce((s,t)=>s+t.investedAmount,0),1)-1)*100).toFixed(2),"%"]})})]})]})})]})]})]})]})})}export{ne as default};
