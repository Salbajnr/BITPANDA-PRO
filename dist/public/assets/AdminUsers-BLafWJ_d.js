import{W as P,j as e,ao as n,r as i,a as J,c as O,d as Y,ap as Z,q as f,aq as y,U as k,C as A,h as R,i as F,l as M,af as ee,I as se,ag as L,ah as q,ai as H,aj as $,ak as j,B as z,ar as ae,a2 as I}from"./index-locF26TT.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=P("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=P("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function ie({title:t,description:l,actions:a,className:N}){return e.jsxs("div",{className:n("flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",N),children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground","data-testid":"page-title",children:t}),l&&e.jsx("p",{className:"text-muted-foreground mt-2","data-testid":"page-description",children:l})]}),a&&e.jsx("div",{className:"flex items-center gap-2","data-testid":"page-actions",children:a})]})}const D=i.forwardRef(({className:t,...l},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:n("w-full caption-bottom text-sm",t),...l})}));D.displayName="Table";const E=i.forwardRef(({className:t,...l},a)=>e.jsx("thead",{ref:a,className:n("[&_tr]:border-b",t),...l}));E.displayName="TableHeader";const B=i.forwardRef(({className:t,...l},a)=>e.jsx("tbody",{ref:a,className:n("[&_tr:last-child]:border-0",t),...l}));B.displayName="TableBody";const re=i.forwardRef(({className:t,...l},a)=>e.jsx("tfoot",{ref:a,className:n("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...l}));re.displayName="TableFooter";const w=i.forwardRef(({className:t,...l},a)=>e.jsx("tr",{ref:a,className:n("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...l}));w.displayName="TableRow";const d=i.forwardRef(({className:t,...l},a)=>e.jsx("th",{ref:a,className:n("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...l}));d.displayName="TableHead";const c=i.forwardRef(({className:t,...l},a)=>e.jsx("td",{ref:a,className:n("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...l}));c.displayName="TableCell";const ne=i.forwardRef(({className:t,...l},a)=>e.jsx("caption",{ref:a,className:n("mt-4 text-sm text-muted-foreground",t),...l}));ne.displayName="TableCaption";function ce(){const[t,l]=i.useState(""),[a,N]=i.useState("all"),[b,_]=i.useState("all"),[r,x]=i.useState(1),[g]=i.useState(20),{toast:C}=J(),{data:T,isLoading:p}=O({queryKey:["/api/admin/users",r,g,t,a,b],queryFn:()=>{const s=new URLSearchParams({page:r.toString(),limit:g.toString(),...t&&{search:t},...a!=="all"&&{role:a},...b!=="all"&&{status:b}});return I("GET",`/api/admin/users?${s}`)}}),m=T?.users||[],h=T?.total||0,v=Math.ceil(h/g),S=m.filter(s=>s.isActive).length,V=m.length-S,K=m.filter(s=>s.role==="admin").length,U=Y({mutationFn:async({userId:s,isActive:o})=>await I("PATCH",`/api/admin/users/${s}/status`,{isActive:o}),onSuccess:()=>{ae.invalidateQueries({queryKey:["/api/admin/users"]}),C({title:"Success",description:"User status updated successfully"})},onError:()=>{C({title:"Error",description:"Failed to update user status",variant:"destructive"})}}),Q=s=>{l(s),x(1)},X=s=>{N(s),x(1)},G=s=>{_(s),x(1)},W=(s,o)=>{U.mutate({userId:s,isActive:!o})};return e.jsxs(Z,{showSidebar:!0,showTicker:!1,children:[e.jsx(ie,{title:"User Management",description:"Manage user accounts, roles, and permissions",actions:e.jsx(f,{"data-testid":"button-create-user",children:"Create User"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx(y,{title:"Total Users",value:h.toString(),icon:k,loading:p}),e.jsx(y,{title:"Active Users",value:S.toString(),icon:te,loading:p,change:{value:h>0?`${(S/m.length*100).toFixed(1)}%`:"0%",trend:"up"}}),e.jsx(y,{title:"Inactive Users",value:V.toString(),icon:le,loading:p}),e.jsx(y,{title:"Admin Users",value:K.toString(),icon:k,loading:p})]}),e.jsxs(A,{className:"mb-6",children:[e.jsx(R,{children:e.jsx(F,{children:"Filter Users"})}),e.jsx(M,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(se,{placeholder:"Search users by name, email, or username...",value:t,onChange:s=>Q(s.target.value),className:"pl-10","data-testid":"input-search-users"})]})}),e.jsxs(L,{value:a,onValueChange:X,children:[e.jsx(q,{className:"w-[150px]","data-testid":"select-role-filter",children:e.jsx(H,{placeholder:"Role"})}),e.jsxs($,{children:[e.jsx(j,{value:"all",children:"All Roles"}),e.jsx(j,{value:"user",children:"User"}),e.jsx(j,{value:"admin",children:"Admin"})]})]}),e.jsxs(L,{value:b,onValueChange:G,children:[e.jsx(q,{className:"w-[150px]","data-testid":"select-status-filter",children:e.jsx(H,{placeholder:"Status"})}),e.jsxs($,{children:[e.jsx(j,{value:"all",children:"All Status"}),e.jsx(j,{value:"active",children:"Active"}),e.jsx(j,{value:"inactive",children:"Inactive"})]})]})]})})]}),e.jsxs(A,{children:[e.jsx(R,{children:e.jsxs(F,{children:["Users (",h," total, showing ",m.length," on page ",r,")"]})}),e.jsxs(M,{children:[p?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,o)=>e.jsx("div",{className:"h-12 bg-muted animate-pulse rounded"},o))}):e.jsxs(D,{children:[e.jsx(E,{children:e.jsxs(w,{children:[e.jsx(d,{children:"User"}),e.jsx(d,{children:"Email"}),e.jsx(d,{children:"Role"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Created"}),e.jsx(d,{children:"Last Login"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(B,{children:m.map(s=>e.jsxs(w,{"data-testid":`row-user-${s.id}`,children:[e.jsx(c,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.firstName," ",s.lastName]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["@",s.username]})]})}),e.jsx(c,{"data-testid":`text-email-${s.id}`,children:s.email}),e.jsx(c,{children:e.jsx(z,{variant:s.role==="admin"?"default":"secondary",children:s.role})}),e.jsx(c,{children:e.jsx(z,{variant:s.isActive?"default":"secondary",children:s.isActive?"Active":"Inactive"})}),e.jsx(c,{"data-testid":`text-created-${s.id}`,children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(c,{"data-testid":`text-last-login-${s.id}`,children:s.lastLogin?new Date(s.lastLogin).toLocaleDateString():"Never"}),e.jsx(c,{children:e.jsx(f,{variant:"outline",size:"sm",onClick:()=>W(s.id,s.isActive),disabled:U.isPending,"data-testid":`button-toggle-status-${s.id}`,children:s.isActive?"Deactivate":"Activate"})})]},s.id))})]}),v>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(r-1)*g+1," to ",Math.min(r*g,h)," of ",h," users"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>x(r-1),disabled:r===1,"data-testid":"button-prev-page",children:"Previous"}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,v)},(s,o)=>{const u=Math.max(1,Math.min(v-4,r-2))+o;return u<=v?e.jsx(f,{variant:u===r?"default":"outline",size:"sm",onClick:()=>x(u),"data-testid":`button-page-${u}`,className:"min-w-[40px]",children:u},u):null})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>x(r+1),disabled:r===v,"data-testid":"button-next-page",children:"Next"})]})]})]})]})]})}export{ce as default};
