import{W as _,a as J,b as ee,r as o,c as A,d as K,j as e,C as x,l as h,ay as S,_ as P,O as q,m as B,az as M,L as i,af as se,I as ae,ag as E,ah as L,ai as Y,aj as I,ak as m,q as r,aD as ie,h as te,i as ne,aE as le,o as O,p as re,a8 as ce,s as Q,t as U,v as V,Y as de,aF as oe,aG as xe,a6 as w,a2 as b,B as he}from"./index-locF26TT.js";import{M as me}from"./message-square-C8zpVQLp.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=_("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=_("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);function Ne(){const{toast:u}=J(),v=ee(),[n,k]=o.useState(1),[p,H]=o.useState(""),[N,G]=o.useState(""),[l,C]=o.useState([]),[g,D]=o.useState({open:!1}),[z,f]=o.useState(!1),[a,c]=o.useState({status:"",rejectionReason:"",notes:""}),{data:d,isLoading:Z}=A({queryKey:["/api/kyc/admin/verifications",n,p,N],queryFn:()=>{const s=new URLSearchParams({page:n.toString(),limit:"20",...p&&{status:p},...N&&{search:N}});return b("GET",`/api/kyc/admin/verifications?${s}`)}}),{data:j}=A({queryKey:["/api/kyc/admin/statistics"],queryFn:()=>b("GET","/api/kyc/admin/statistics")}),y=K({mutationFn:({id:s,data:t})=>b("POST",`/api/kyc/admin/verifications/${s}/review`,t),onSuccess:()=>{u({title:"KYC reviewed successfully",description:"The verification status has been updated."}),v.invalidateQueries({queryKey:["/api/kyc/admin/verifications"]}),v.invalidateQueries({queryKey:["/api/kyc/admin/statistics"]}),D({open:!1}),c({status:"",rejectionReason:"",notes:""})},onError:s=>{u({title:"Review failed",description:s.message||"Failed to review KYC verification",variant:"destructive"})}}),R=K({mutationFn:s=>b("POST","/api/kyc/admin/verifications/bulk-review",s),onSuccess:()=>{u({title:"Bulk review completed",description:"Selected verifications have been updated."}),v.invalidateQueries({queryKey:["/api/kyc/admin/verifications"]}),v.invalidateQueries({queryKey:["/api/kyc/admin/statistics"]}),f(!1),C([]),c({status:"",rejectionReason:"",notes:""})},onError:s=>{u({title:"Bulk review failed",description:s.message||"Failed to review selected verifications",variant:"destructive"})}}),F=s=>{if(!g.kyc)return;const t={status:s,rejectionReason:s==="rejected"?a.rejectionReason:void 0,notes:a.notes};y.mutate({id:g.kyc.id,data:t})},$=()=>{if(l.length===0||!a.status)return;const s={ids:l,status:a.status,rejectionReason:a.status==="rejected"?a.rejectionReason:void 0,notes:a.notes};R.mutate(s)},T=s=>{const t={pending:"secondary",under_review:"outline",approved:"default",rejected:"destructive"};return e.jsx(he,{variant:t[s]||"secondary",children:s.replace("_"," ").toUpperCase()})},W=s=>{switch(s){case"approved":return e.jsx(B,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(M,{className:"h-4 w-4 text-red-500"});case"under_review":return e.jsx(P,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(q,{className:"h-4 w-4 text-orange-500"})}};return Z?e.jsxs("div",{className:"space-y-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded w-1/3"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((s,t)=>e.jsx("div",{className:"h-24 bg-slate-200 dark:bg-slate-700 rounded"},t))}),e.jsx("div",{className:"h-96 bg-slate-200 dark:bg-slate-700 rounded"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"KYC Management"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Review and manage user identity verifications"})]}),j&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(x,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:j.total})]})]})})}),e.jsx(x,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-8 w-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold",children:j.pending})]})]})})}),e.jsx(x,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"h-8 w-8 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Under Review"}),e.jsx("p",{className:"text-2xl font-bold",children:j.underReview})]})]})})}),e.jsx(x,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold",children:j.approved})]})]})})}),e.jsx(x,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-8 w-8 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-400",children:"Rejected"}),e.jsx("p",{className:"text-2xl font-bold",children:j.rejected})]})]})})})]}),e.jsx(x,{children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{htmlFor:"search",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(ae,{id:"search",placeholder:"Search by name, email, or username...",value:N,onChange:s=>G(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"status-filter",children:"Status Filter"}),e.jsxs(E,{value:p,onValueChange:H,children:[e.jsx(L,{className:"w-48",children:e.jsx(Y,{placeholder:"All statuses"})}),e.jsxs(I,{children:[e.jsx(m,{value:"",children:"All statuses"}),e.jsx(m,{value:"pending",children:"Pending"}),e.jsx(m,{value:"under_review",children:"Under Review"}),e.jsx(m,{value:"approved",children:"Approved"}),e.jsx(m,{value:"rejected",children:"Rejected"})]})]})]}),l.length>0&&e.jsxs(r,{onClick:()=>f(!0),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Bulk Review (",l.length,")"]})]})})}),e.jsxs(x,{children:[e.jsx(te,{children:e.jsx(ne,{children:"KYC Verifications"})}),e.jsxs(h,{children:[d?.verifications?.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(S,{className:"h-12 w-12 mx-auto text-slate-400 mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No KYC verifications found"})]}):e.jsx("div",{className:"space-y-4",children:d?.verifications?.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-slate-50 dark:hover:bg-slate-800/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(le,{checked:l.includes(s.id),onCheckedChange:t=>{C(t?[...l,s.id]:l.filter(X=>X!==s.id))}}),e.jsxs("div",{className:"flex items-center space-x-2",children:[W(s.status),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold",children:[s.firstName," ",s.lastName]}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[s.userEmail," â€¢ ",s.nationality]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[T(s.status),e.jsxs(O,{open:g.open&&g.kyc?.id===s.id,onOpenChange:t=>D({open:t,kyc:t?s:void 0}),children:[e.jsx(re,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Review"]})}),e.jsxs(Q,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(U,{children:e.jsx(V,{children:"Review KYC Verification"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Personal Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"First Name"}),e.jsx("p",{className:"font-medium",children:s.firstName})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Last Name"}),e.jsx("p",{className:"font-medium",children:s.lastName})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Date of Birth"}),e.jsx("p",{className:"font-medium",children:new Date(s.dateOfBirth).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Nationality"}),e.jsx("p",{className:"font-medium",children:s.nationality})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone Number"}),e.jsx("p",{className:"font-medium",children:s.phoneNumber})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Address Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(i,{children:"Address"}),e.jsx("p",{className:"font-medium",children:s.address})]}),e.jsxs("div",{children:[e.jsx(i,{children:"City"}),e.jsx("p",{className:"font-medium",children:s.city})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Postal Code"}),e.jsx("p",{className:"font-medium",children:s.postalCode})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Country"}),e.jsx("p",{className:"font-medium",children:s.country})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),"Document Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Document Type"}),e.jsx("p",{className:"font-medium",children:s.documentType.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Document Number"}),e.jsx("p",{className:"font-medium",children:s.documentNumber})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Submission Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Submitted"}),e.jsx("p",{className:"font-medium",children:new Date(s.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsx("div",{children:T(s.status)})]}),s.reviewedAt&&e.jsxs("div",{children:[e.jsx(i,{children:"Reviewed"}),e.jsx("p",{className:"font-medium",children:new Date(s.reviewedAt).toLocaleString()})]}),s.rejectionReason&&e.jsxs("div",{className:"col-span-2",children:[e.jsx(i,{children:"Rejection Reason"}),e.jsx("p",{className:"font-medium text-red-600",children:s.rejectionReason})]})]})]}),s.status!=="approved"&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"Review Decision"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(w,{id:"notes",value:a.notes,onChange:t=>c({...a,notes:t.target.value}),placeholder:"Add any notes about this verification..."})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"rejection-reason",children:"Rejection Reason (Required if rejecting)"}),e.jsx(w,{id:"rejection-reason",value:a.rejectionReason,onChange:t=>c({...a,rejectionReason:t.target.value}),placeholder:"Explain why this verification is being rejected..."})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(r,{onClick:()=>F("approved"),className:"flex items-center gap-2",disabled:y.isPending,children:[e.jsx(ue,{className:"h-4 w-4"}),"Approve"]}),e.jsxs(r,{onClick:()=>F("rejected"),variant:"destructive",className:"flex items-center gap-2",disabled:y.isPending||!a.rejectionReason,children:[e.jsx(je,{className:"h-4 w-4"}),"Reject"]})]})]})]})]})]})]})]})]})},s.id))}),d?.pagination&&d.pagination.pages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Showing ",(n-1)*20+1," to ",Math.min(n*20,d.pagination.total)," of ",d.pagination.total," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{variant:"outline",onClick:()=>k(n-1),disabled:n===1,children:"Previous"}),e.jsx(r,{variant:"outline",onClick:()=>k(n+1),disabled:n===d.pagination.pages,children:"Next"})]})]})]})]}),e.jsx(O,{open:z,onOpenChange:f,children:e.jsxs(Q,{children:[e.jsx(U,{children:e.jsx(V,{children:"Bulk Review KYC Verifications"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:["You are about to review ",l.length," KYC verification(s)."]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"bulk-status",children:"Action"}),e.jsxs(E,{value:a.status,onValueChange:s=>c({...a,status:s}),children:[e.jsx(L,{children:e.jsx(Y,{placeholder:"Select action"})}),e.jsxs(I,{children:[e.jsx(m,{value:"approved",children:"Approve"}),e.jsx(m,{value:"rejected",children:"Reject"})]})]})]}),a.status==="rejected"&&e.jsxs("div",{children:[e.jsx(i,{htmlFor:"bulk-rejection-reason",children:"Rejection Reason"}),e.jsx(w,{id:"bulk-rejection-reason",value:a.rejectionReason,onChange:s=>c({...a,rejectionReason:s.target.value}),placeholder:"Explain why these verifications are being rejected..."})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"bulk-notes",children:"Notes (Optional)"}),e.jsx(w,{id:"bulk-notes",value:a.notes,onChange:s=>c({...a,notes:s.target.value}),placeholder:"Add any notes about these verifications..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(r,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(r,{onClick:$,disabled:!a.status||R.isPending||a.status==="rejected"&&!a.rejectionReason,children:R.isPending?"Processing...":"Confirm Bulk Review"})]})]})]})})]})}export{Ne as default};
