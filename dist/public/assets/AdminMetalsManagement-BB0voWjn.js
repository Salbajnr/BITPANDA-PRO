import{u as F,a as L,r as t,j as e,q as N,R as M,C as l,l as r,D as k,Q as O,U as $,F as D,T as E,e as H,f as x,g as m,h as i,i as n,B as h,V as R,O as X,I as p}from"./index-locF26TT.js";function z(){const{user:d}=F(),{toast:u}=L(),[f,y]=t.useState([]),[c,b]=t.useState(null),[w,T]=t.useState([]),[S,g]=t.useState(!0),[V,G]=t.useState(""),[a,o]=t.useState({symbol:"",price:"",reason:""});t.useEffect(()=>{d?.role==="admin"&&v()},[d]);const v=async()=>{g(!0);try{await Promise.all([A(),C(),P()])}catch(s){console.error("Error fetching admin data:",s)}finally{g(!1)}},A=async()=>{try{const s=await fetch("/api/metals-trading/admin/transactions",{credentials:"include"});if(s.ok){const j=await s.json();y(j.transactions)}}catch(s){console.error("Failed to fetch transactions:",s)}},C=async()=>{try{b({totalVolume:125e4,totalTransactions:847,totalUsers:234,topMetals:[{symbol:"XAU",name:"Gold",volume:75e4,transactions:456},{symbol:"XAG",name:"Silver",volume:32e4,transactions:234},{symbol:"XPT",name:"Platinum",volume:12e4,transactions:98},{symbol:"XPD",name:"Palladium",volume:6e4,transactions:59}]})}catch(s){console.error("Failed to fetch stats:",s)}},P=async()=>{try{T([{userId:"1",username:"john_doe",email:"john@example.com",symbol:"XAU",name:"Gold",amount:"2.5",value:5114.18,profitLoss:234.18},{userId:"2",username:"jane_smith",email:"jane@example.com",symbol:"XAG",name:"Silver",amount:"50.0",value:1244.5,profitLoss:-45.5}])}catch(s){console.error("Failed to fetch user holdings:",s)}},U=async()=>{try{if((await fetch("/api/metals-trading/admin/price-override",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)})).ok)u({title:"Price Override Logged",description:"Price override has been recorded for audit purposes",variant:"default"}),o({symbol:"",price:"",reason:""});else throw new Error("Failed to log price override")}catch(s){console.error("Error logging price override:",s),u({title:"Error",description:"Failed to log price override",variant:"destructive"})}};return!d||d.role!=="admin"?e.jsx("div",{children:"Access denied. Admin privileges required."}):S?e.jsx("div",{children:"Loading admin dashboard..."}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Metals Management"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Admin dashboard for precious metals oversight"})]}),e.jsxs(N,{onClick:v,variant:"outline",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Refresh Data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Volume"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",c?.totalVolume.toLocaleString()]})]}),e.jsx(k,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold",children:c?.totalTransactions})]}),e.jsx(O,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-bold",children:c?.totalUsers})]}),e.jsx($,{className:"w-8 h-8 text-purple-600"})]})})}),e.jsx(l,{children:e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Top Metal"}),e.jsx("p",{className:"text-2xl font-bold",children:c?.topMetals[0]?.name})]}),e.jsx(D,{className:"w-8 h-8 text-orange-600"})]})})})]}),e.jsxs(E,{defaultValue:"transactions",className:"space-y-6",children:[e.jsxs(H,{className:"grid w-full grid-cols-4",children:[e.jsx(x,{value:"transactions",children:"Transactions"}),e.jsx(x,{value:"holdings",children:"User Holdings"}),e.jsx(x,{value:"analytics",children:"Analytics"}),e.jsx(x,{value:"settings",children:"Settings"})]}),e.jsx(m,{value:"transactions",children:e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(n,{children:"Recent Metal Transactions"})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:s.type==="buy"?"default":"secondary",children:s.type.toUpperCase()}),e.jsx("span",{className:"font-semibold",children:s.symbol}),e.jsx("span",{className:"text-gray-500",children:"•"}),e.jsx("span",{className:"text-sm",children:s.username})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(s.createdAt).toLocaleDateString()," • ",s.email]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["$",parseFloat(s.total).toFixed(2)]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.amount," oz @ $",parseFloat(s.price).toFixed(2)]})]})]})},s.id))})})]})}),e.jsx(m,{value:"holdings",children:e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(n,{children:"User Holdings Overview"})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:w.map((s,j)=>e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold",children:s.name}),e.jsx("span",{className:"text-gray-500",children:"•"}),e.jsx("span",{className:"text-sm",children:s.username})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.amount," oz • ",s.email]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["$",s.value.toFixed(2)]}),e.jsxs("p",{className:`text-sm ${s.profitLoss>=0?"text-green-600":"text-red-500"}`,children:[s.profitLoss>=0?"+":"","$",s.profitLoss.toFixed(2)]})]})]})},j))})})]})}),e.jsx(m,{value:"analytics",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(n,{children:"Metal Performance"})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:c?.topMetals.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.symbol})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["$",s.volume.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.transactions," transactions"]})]})]},s.symbol))})})]}),e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(n,{children:"Trading Activity"})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-semibold text-blue-800",children:"Daily Volume"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:"$125,400"}),e.jsx("p",{className:"text-sm text-blue-600",children:"+12.5% from yesterday"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-semibold text-green-800",children:"Active Traders"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:"68"}),e.jsx("p",{className:"text-sm text-green-600",children:"+8 new today"})]})]})})]})]})}),e.jsx(m,{value:"settings",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(i,{children:e.jsxs(n,{className:"flex items-center",children:[e.jsx(R,{className:"w-5 h-5 mr-2"}),"Price Override"]})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(X,{className:"w-4 h-4 text-yellow-600 mr-2"}),e.jsx("span",{className:"text-sm text-yellow-800",children:"Price overrides are logged for audit purposes"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Metal Symbol"}),e.jsx(p,{value:a.symbol,onChange:s=>o({...a,symbol:s.target.value}),placeholder:"e.g., XAU, XAG"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Override Price"}),e.jsx(p,{type:"number",step:"0.01",value:a.price,onChange:s=>o({...a,price:s.target.value}),placeholder:"New price per ounce"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason"}),e.jsx(p,{value:a.reason,onChange:s=>o({...a,reason:s.target.value}),placeholder:"Reason for price override"})]}),e.jsx(N,{onClick:U,className:"w-full",disabled:!a.symbol||!a.price||!a.reason,children:"Log Price Override"})]})})]}),e.jsxs(l,{children:[e.jsx(i,{children:e.jsx(n,{children:"Trading Controls"})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Metal Trading"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Enable/disable metal trading"})]}),e.jsx(h,{variant:"default",children:"Active"})]})}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Price Feeds"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Real-time price updates"})]}),e.jsx(h,{variant:"default",children:"Connected"})]})}),e.jsx("div",{className:"p-4 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Storage Fees"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Monthly storage charges"})]}),e.jsx(h,{variant:"secondary",children:"$2.50/oz/month"})]})})]})})]})]})})]})]})})}export{z as default};
