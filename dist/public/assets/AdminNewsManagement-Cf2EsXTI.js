import{r as c,a as $,j as e,C as i,h as j,i as u,o as E,p as K,q as o,a4 as S,s as U,t as D,v as T,a5 as F,L as l,I as m,a6 as N,a7 as k,k as Q,l as n,H as W,a8 as L,B as G,a9 as X,aa as Y,S as Z,N as _,ab as O,c as ee,F as se,U as te}from"./index-locF26TT.js";function ae({className:x}){const[h,p]=c.useState([]),[f,P]=c.useState(null),[B,I]=c.useState(!0),[R,v]=c.useState(!1),[M,g]=c.useState(!1),[b,C]=c.useState(null),[a,r]=c.useState({title:"",content:"",excerpt:"",imageUrl:"",source:"Admin",sourceUrl:"",publishedAt:new Date}),{toast:d}=$();c.useEffect(()=>{w(),y()},[]);const w=async()=>{try{const s=await fetch("/api/news");if(s.ok){const t=await s.json();p(t)}}catch(s){console.error("Error fetching articles:",s),d({title:"Error",description:"Failed to fetch news articles",variant:"destructive"})}finally{I(!1)}},y=async()=>{try{const s=await fetch("/api/news/admin/analytics");if(s.ok){const t=await s.json();P(t)}}catch(s){console.error("Error fetching analytics:",s)}},q=async()=>{try{const s=await fetch("/api/news",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(s.ok)d({title:"Success",description:"News article created successfully"}),v(!1),A(),w(),y();else{const t=await s.json();throw new Error(t.message)}}catch(s){console.error("Error creating article:",s),d({title:"Error",description:"Failed to create news article",variant:"destructive"})}},V=async()=>{if(b)try{const s=await fetch(`/api/news/${b.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(s.ok)d({title:"Success",description:"News article updated successfully"}),g(!1),A(),w();else{const t=await s.json();throw new Error(t.message)}}catch(s){console.error("Error updating article:",s),d({title:"Error",description:"Failed to update news article",variant:"destructive"})}},H=async s=>{if(confirm("Are you sure you want to delete this article?"))try{const t=await fetch(`/api/news/${s}`,{method:"DELETE"});if(t.ok)d({title:"Success",description:"News article deleted successfully"}),w(),y();else{const J=await t.json();throw new Error(J.message)}}catch(t){console.error("Error deleting article:",t),d({title:"Error",description:"Failed to delete news article",variant:"destructive"})}},A=()=>{r({title:"",content:"",excerpt:"",imageUrl:"",source:"Admin",sourceUrl:"",publishedAt:new Date}),C(null)},z=s=>{C(s),r({title:s.title,content:s.content||"",excerpt:s.excerpt||"",imageUrl:s.imageUrl||"",source:s.source,sourceUrl:s.sourceUrl||"",publishedAt:s.publishedAt}),g(!0)};return B?e.jsx("div",{className:"flex justify-center p-8",children:"Loading..."}):e.jsxs("div",{className:x,children:[e.jsxs(i,{children:[e.jsxs(j,{children:[e.jsxs(u,{className:"flex items-center justify-between",children:["News Management",e.jsxs(E,{open:R,onOpenChange:v,children:[e.jsx(K,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Create Article"]})}),e.jsxs(U,{className:"max-w-2xl",children:[e.jsxs(D,{children:[e.jsx(T,{children:"Create News Article"}),e.jsx(F,{children:"Create a new news article for the platform"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"title",children:"Title"}),e.jsx(m,{id:"title",value:a.title,onChange:s=>r(t=>({...t,title:s.target.value})),placeholder:"Article title"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"excerpt",children:"Excerpt"}),e.jsx(N,{id:"excerpt",value:a.excerpt,onChange:s=>r(t=>({...t,excerpt:s.target.value})),placeholder:"Brief description",rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"content",children:"Content"}),e.jsx(N,{id:"content",value:a.content,onChange:s=>r(t=>({...t,content:s.target.value})),placeholder:"Article content",rows:6})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"imageUrl",children:"Image URL"}),e.jsx(m,{id:"imageUrl",value:a.imageUrl,onChange:s=>r(t=>({...t,imageUrl:s.target.value})),placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"source",children:"Source"}),e.jsx(m,{id:"source",value:a.source,onChange:s=>r(t=>({...t,source:s.target.value})),placeholder:"News source"})]})]}),e.jsxs(k,{children:[e.jsx(o,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(o,{onClick:q,children:"Create Article"})]})]})]})]}),e.jsx(Q,{children:"Manage news articles and platform updates"})]}),e.jsxs(n,{children:[f&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Total Articles"}),e.jsx("p",{className:"text-2xl font-bold",children:f.totalArticles})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"This Week"}),e.jsx("p",{className:"text-2xl font-bold",children:f.recentArticles})]})]})})}),e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"ml-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Sources"}),e.jsx("p",{className:"text-2xl font-bold",children:f.articlesBySource?.length||0})]})]})})})]}),e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsx(i,{children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.excerpt}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{variant:"secondary",children:s.source}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.publishedAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>z(s),children:e.jsx(X,{className:"w-4 h-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>H(s.id),children:e.jsx(Y,{className:"w-4 h-4"})})]})]})})},s.id))})]})]}),e.jsx(E,{open:M,onOpenChange:g,children:e.jsxs(U,{className:"max-w-2xl",children:[e.jsxs(D,{children:[e.jsx(T,{children:"Edit News Article"}),e.jsx(F,{children:"Update the news article details"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-title",children:"Title"}),e.jsx(m,{id:"edit-title",value:a.title,onChange:s=>r(t=>({...t,title:s.target.value})),placeholder:"Article title"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-excerpt",children:"Excerpt"}),e.jsx(N,{id:"edit-excerpt",value:a.excerpt,onChange:s=>r(t=>({...t,excerpt:s.target.value})),placeholder:"Brief description",rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-content",children:"Content"}),e.jsx(N,{id:"edit-content",value:a.content,onChange:s=>r(t=>({...t,content:s.target.value})),placeholder:"Article content",rows:6})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-imageUrl",children:"Image URL"}),e.jsx(m,{id:"edit-imageUrl",value:a.imageUrl,onChange:s=>r(t=>({...t,imageUrl:s.target.value})),placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"edit-source",children:"Source"}),e.jsx(m,{id:"edit-source",value:a.source,onChange:s=>r(t=>({...t,source:s.target.value})),placeholder:"News source"})]})]}),e.jsxs(k,{children:[e.jsx(o,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(o,{onClick:V,children:"Update Article"})]})]})})]})}function re(){const{data:x}=ee({queryKey:["/api/news/analytics"],queryFn:async()=>{const p=await fetch("/api/news/analytics",{credentials:"include"});if(!p.ok)throw new Error("Failed to fetch news stats");return p.json()}}),h={totalArticles:x?.totalArticles||0,publishedToday:x?.publishedToday||0,totalViews:x?.totalViews||0,engagementRate:x?.engagementRate||0};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(i,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Articles"}),e.jsx(O,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.totalArticles}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time articles"})]})]}),e.jsxs(i,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Published Today"}),e.jsx(se,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.publishedToday}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Published today"})]})]}),e.jsxs(i,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Views"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(n,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.totalViews.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total article views"})]})]}),e.jsxs(i,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Engagement"}),e.jsx(te,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(n,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[h.engagementRate.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"User engagement rate"})]})]})]})}function ie(){return e.jsx("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900",children:e.jsxs("div",{className:"flex h-screen",children:[e.jsx(Z,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(_,{}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:"News Management"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Create and manage platform news and updates"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(O,{className:"w-8 h-8 text-blue-500"})})]})}),e.jsx(re,{}),e.jsx(ae,{})]})]})]})})}export{ie as default};
